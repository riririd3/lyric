<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synced Lyrics Viewer</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: black; color: white; margin: 0; padding: 0; }
        #lyrics-container { height: 60vh; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #lyrics { font-size: 28px; line-height: 1.8; text-align: center; transition: transform 0.5s ease-in-out; }
        .highlight { color: #1DB954; font-weight: bold; font-size: 36px; }
    </style>
</head>
<body>

    <h2 style="color: white;">Synced Lyrics Viewer</h2>
    <div id="lyrics-container">
        <div id="lyrics">Loading lyrics...</div>
    </div>

    <script>
        let lyrics = [];
        let currentLine = 0;
        let startTime = 0;

        function loadLRC() {
            fetch("lyrics.lrc")
                .then(response => response.text())
                .then(text => {
                    lyrics = parseLRC(text);
                    displayLyrics();
                    startLyrics();
                })
                .catch(error => {
                    document.getElementById('lyrics').innerText = "Error loading lyrics.";
                    console.error("Error loading LRC file:", error);
                });
        }

        function parseLRC(text) {
            return text.trim().split("\n").map(line => {
                const match = line.match(/\[(\d+):(\d+\.\d+)\](.*)/);
                if (match) {
                    return { time: parseFloat(match[1]) * 60 + parseFloat(match[2]), text: match[3].trim() };
                }
                return null;
            }).filter(Boolean);
        }

        function displayLyrics() {
            const lyricsDiv = document.getElementById('lyrics');
            lyricsDiv.innerHTML = lyrics.map(l => `<p>${l.text}</p>`).join("");
        }

        function startLyrics() {
            startTime = Date.now();
            currentLine = 0;
            updateLyrics();
        }

        function updateLyrics() {
            if (currentLine >= lyrics.length) return;
            const elapsed = (Date.now() - startTime) / 1000;
            if (elapsed >= lyrics[currentLine].time) {
                highlightLine();
                currentLine++;
            }
            requestAnimationFrame(updateLyrics);
        }

        function highlightLine() {
            const lyricsDiv = document.getElementById('lyrics');
            const lines = lyricsDiv.getElementsByTagName("p");

            // Reset all styles
            for (let i = 0; i < lines.length; i++) {
                lines[i].classList.remove("highlight");
            }

            // Highlight current line
            if (lines[currentLine]) {
                lines[currentLine].classList.add("highlight");

                // Auto-scroll
                const container = document.getElementById("lyrics-container");
                const lineHeight = lines[currentLine].offsetHeight;
                container.scrollTo({ top: lineHeight * currentLine - container.clientHeight / 2, behavior: "smooth" });
            }
        }

        // Load LRC file when the page loads
        loadLRC();
    </script>

</body>
</html>
