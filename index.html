<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synced Lyrics Viewer</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
        #lyrics { font-size: 24px; height: 100px; overflow: hidden; }
        .highlight { color: red; font-weight: bold; }
    </style>
</head>
<body>

    <h2>Synced Lyrics Viewer</h2>
    <div id="lyrics">Loading lyrics...</div>

    <script>
        let lyrics = [];
        let currentLine = 0;
        let startTime = 0;

        function loadLRC() {
            fetch("lyrics.lrc")
                .then(response => response.text())
                .then(text => {
                    lyrics = parseLRC(text);
                    displayLyrics();
                    startLyrics();
                })
                .catch(error => {
                    document.getElementById('lyrics').innerText = "Error loading lyrics.";
                    console.error("Error loading LRC file:", error);
                });
        }

        function parseLRC(text) {
            return text.trim().split("\n").map(line => {
                const match = line.match(/\[(\d+):(\d+\.\d+)\](.*)/);
                if (match) {
                    return { time: parseFloat(match[1]) * 60 + parseFloat(match[2]), text: match[3].trim() };
                }
                return null;
            }).filter(Boolean);
        }

        function displayLyrics() {
            const lyricsDiv = document.getElementById('lyrics');
            lyricsDiv.innerHTML = lyrics.map(l => `<p>${l.text}</p>`).join("");
        }

        function startLyrics() {
            startTime = Date.now();
            currentLine = 0;
            updateLyrics();
        }

        function updateLyrics() {
            if (currentLine >= lyrics.length) return;
            const elapsed = (Date.now() - startTime) / 1000;
            if (elapsed >= lyrics[currentLine].time) {
                highlightLine();
                currentLine++;
            }
            requestAnimationFrame(updateLyrics);
        }

        function highlightLine() {
            const lyricsDiv = document.getElementById('lyrics');
            const lines = lyricsDiv.getElementsByTagName("p");
            for (let i = 0; i < lines.length; i++) {
                lines[i].classList.toggle("highlight", i === currentLine);
            }
        }

        // Load LRC file when the page loads
        loadLRC();
    </script>

</body>
</html>
